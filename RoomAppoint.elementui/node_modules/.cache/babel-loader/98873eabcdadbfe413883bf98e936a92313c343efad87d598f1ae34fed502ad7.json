{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport ValidCode from '@/components/Code/canvas.vue';\nimport store from '@/store';\nexport default {\n  name: 'Login',\n  components: {\n    ValidCode\n  },\n  data() {\n    return {\n      formData: {\n        UserName: '',\n        Password: '',\n        RoleType: '',\n        Code: ''\n      },\n      roleOptions: [],\n      loading: false,\n      rules: {\n        UserName: [{\n          required: true,\n          message: '请输入账号',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 20,\n          message: '账号长度为3-20个字符',\n          trigger: 'blur'\n        }],\n        Password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }, {\n          min: 1,\n          max: 20,\n          message: '密码长度为6-20个字符',\n          trigger: 'blur'\n        }],\n        RoleType: [{\n          required: true,\n          message: '请选择角色',\n          trigger: 'change'\n        }],\n        Code: [{\n          required: true,\n          message: '请输入验证码',\n          trigger: 'blur'\n        }, {\n          validator: (rule, value, callback) => {\n            let identifyCode = this.$refs.ValidCode?.getCode();\n            if (!identifyCode || value !== identifyCode) {\n              callback(new Error('验证码不正确'));\n            } else {\n              callback();\n            }\n          },\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created() {\n    this.GetRoleTypeApi();\n  },\n  methods: {\n    async GetRoleTypeApi() {\n      try {\n        const {\n          Data: {\n            Items\n          }\n        } = await this.$Post(\"/Select/RoleType\");\n        this.roleOptions = Items;\n        // 设置默认角色\n        if (Items.length > 0 && !this.formData.RoleType) {\n          this.formData.RoleType = Items[0].Code;\n        }\n      } catch (error) {\n        console.error('获取角色类型失败:', error);\n      }\n    },\n    async LoginBtn() {\n      try {\n        await this.$refs.loginForm.validate();\n        this.loading = true;\n        const res = await store.dispatch(\"Login\", this.formData);\n        if (res.Success) {\n          this.$message.success({\n            message: \"登录成功！\",\n            duration: 1500,\n            showClose: true\n          });\n\n          // 延迟跳转，让用户看到成功提示\n          setTimeout(() => {\n            this.$router.push({\n              path: \"/Admin\"\n            });\n          }, 1500);\n        } else {\n          this.$message.error(res.Message || \"登录失败，请检查账号密码\");\n          this.$refs.ValidCode?.refreshCode();\n        }\n      } catch (error) {\n        console.error('登录失败:', error);\n        this.$message.error(\"登录验证不通过\");\n        this.$refs.ValidCode?.refreshCode();\n      } finally {\n        this.loading = false;\n      }\n    },\n    ToHome() {\n      this.$router.push({\n        path: \"/Front/Home\"\n      });\n    },\n    forgotPassword() {\n      this.$message.info(\"请联系管理员重置密码\");\n    }\n  }\n};","map":{"version":3,"names":["ValidCode","store","name","components","data","formData","UserName","Password","RoleType","Code","roleOptions","loading","rules","required","message","trigger","min","max","validator","rule","value","callback","identifyCode","$refs","getCode","Error","created","GetRoleTypeApi","methods","Data","Items","$Post","length","error","console","LoginBtn","loginForm","validate","res","dispatch","Success","$message","success","duration","showClose","setTimeout","$router","push","path","Message","refreshCode","ToHome","forgotPassword","info"],"sources":["src/views/Login.vue"],"sourcesContent":["<template>\n  <div class=\"auth-container\">\n    <div class=\"auth-background\">\n      <div class=\"auth-overlay\">\n        <div class=\"auth-logo\">\n          <i class=\"el-icon-reading\"></i>\n          <h1>自习室预约系统</h1>\n          <p>专注学习，高效预约</p>\n        </div>\n      </div>\n    </div>\n    \n    <div class=\"auth-card\">\n      <div class=\"auth-header\">\n        <h2>欢迎回来</h2>\n        <p>请登录您的账户以继续</p>\n      </div>\n      \n      <el-form \n        ref=\"loginForm\" \n        :model=\"formData\" \n        :rules=\"rules\" \n        class=\"auth-form\"\n        @keyup.enter=\"LoginBtn\"\n      >\n        <div class=\"form-group\">\n          <label>账号</label>\n          <el-form-item prop=\"UserName\">\n            <el-input\n              v-model.trim=\"formData.UserName\"\n              placeholder=\"请输入账号\"\n              prefix-icon=\"el-icon-user\"\n              size=\"large\"\n              clearable\n            />\n          </el-form-item>\n        </div>\n        \n        <div class=\"form-group\">\n          <label>密码</label>\n          <el-form-item prop=\"Password\">\n            <el-input\n              v-model.trim=\"formData.Password\"\n              type=\"password\"\n              placeholder=\"请输入密码\"\n              prefix-icon=\"el-icon-lock\"\n              size=\"large\"\n              show-password\n              clearable\n            />\n          </el-form-item>\n        </div>\n        \n        <div class=\"form-group\">\n          <label>角色</label>\n          <el-form-item prop=\"RoleType\">\n            <el-radio-group v-model=\"formData.RoleType\" class=\"role-radio-group\">\n              <el-radio-button\n                v-for=\"item in roleOptions\"\n                :key=\"item.Code\"\n                :label=\"item.Code\"\n              >\n                {{ item.Label }}\n              </el-radio-button>\n            </el-radio-group>\n          </el-form-item>\n        </div>\n        \n        <div class=\"form-group\">\n          <label>验证码</label>\n          <el-form-item prop=\"Code\">\n            <div class=\"code-container\">\n              <el-input\n                v-model.trim=\"formData.Code\"\n                placeholder=\"请输入验证码\"\n                prefix-icon=\"el-icon-key\"\n                size=\"large\"\n                clearable\n                style=\"flex: 1\"\n              />\n              <div class=\"code-image-wrapper\">\n                <ValidCode ref=\"ValidCode\" />\n              </div>\n            </div>\n          </el-form-item>\n        </div>\n        \n        <div class=\"form-actions\">\n          <el-button\n            type=\"primary\"\n            size=\"large\"\n            :loading=\"loading\"\n            @click=\"LoginBtn\"\n            class=\"auth-btn\"\n          >\n            登 录\n          </el-button>\n          \n          <el-button\n            type=\"default\"\n            size=\"large\"\n            @click=\"ToHome\"\n            class=\"home-btn\"\n          >\n            <i class=\"el-icon-s-home\"></i>\n            前台预览\n          </el-button>\n        </div>\n        \n        <div class=\"auth-footer\">\n          <router-link :to=\"{ path: '/Register' }\" class=\"auth-link\">\n            <i class=\"el-icon-user-plus\"></i>\n            立即注册\n          </router-link>\n          <a href=\"javascript:;\" class=\"auth-link\" @click=\"forgotPassword\">\n            <i class=\"el-icon-question\"></i>\n            忘记密码\n          </a>\n        </div>\n        \n        <div class=\"divider\">\n          <span>或</span>\n        </div>\n        \n        <div class=\"social-login\">\n          <el-button class=\"social-btn wechat\" circle>\n            <i class=\"iconfont icon-wechat\"></i>\n          </el-button>\n          <el-button class=\"social-btn qq\" circle>\n            <i class=\"iconfont icon-qq\"></i>\n          </el-button>\n          <el-button class=\"social-btn weibo\" circle>\n            <i class=\"iconfont icon-weibo\"></i>\n          </el-button>\n        </div>\n      </el-form>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ValidCode from '@/components/Code/canvas.vue';\nimport store from '@/store';\n\nexport default {\n  name: 'Login',\n  components: {\n    ValidCode\n  },\n  data() {\n    return {\n      formData: {\n        UserName: '',\n        Password: '',\n        RoleType: '',\n        Code: ''\n      },\n      roleOptions: [],\n      loading: false,\n      rules: {\n        UserName: [\n          { required: true, message: '请输入账号', trigger: 'blur' },\n          { min: 3, max: 20, message: '账号长度为3-20个字符', trigger: 'blur' }\n        ],\n        Password: [\n          { required: true, message: '请输入密码', trigger: 'blur' },\n          { min: 1, max: 20, message: '密码长度为6-20个字符', trigger: 'blur' }\n        ],\n        RoleType: [\n          { required: true, message: '请选择角色', trigger: 'change' }\n        ],\n        Code: [\n          { required: true, message: '请输入验证码', trigger: 'blur' },\n          {\n            validator: (rule, value, callback) => {\n              let identifyCode = this.$refs.ValidCode?.getCode();\n              if (!identifyCode || value !== identifyCode) {\n                callback(new Error('验证码不正确'));\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ]\n      }\n    };\n  },\n  created() {\n    this.GetRoleTypeApi();\n  },\n  methods: {\n    async GetRoleTypeApi() {\n      try {\n        const { Data: { Items } } = await this.$Post(\"/Select/RoleType\");\n        this.roleOptions = Items;\n        // 设置默认角色\n        if (Items.length > 0 && !this.formData.RoleType) {\n          this.formData.RoleType = Items[0].Code;\n        }\n      } catch (error) {\n        console.error('获取角色类型失败:', error);\n      }\n    },\n    \n    async LoginBtn() {\n      try {\n        await this.$refs.loginForm.validate();\n        \n        this.loading = true;\n        const res = await store.dispatch(\"Login\", this.formData);\n        \n        if (res.Success) {\n          this.$message.success({\n            message: \"登录成功！\",\n            duration: 1500,\n            showClose: true\n          });\n          \n          // 延迟跳转，让用户看到成功提示\n          setTimeout(() => {\n            this.$router.push({ path: \"/Admin\" });\n          }, 1500);\n        } else {\n          this.$message.error(res.Message || \"登录失败，请检查账号密码\");\n          this.$refs.ValidCode?.refreshCode();\n        }\n      } catch (error) {\n        console.error('登录失败:', error);\n        this.$message.error(\"登录验证不通过\");\n        this.$refs.ValidCode?.refreshCode();\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    ToHome() {\n      this.$router.push({ path: \"/Front/Home\" });\n    },\n    \n    forgotPassword() {\n      this.$message.info(\"请联系管理员重置密码\");\n    }\n  }\n};\n</script>\n\n<style scoped>\n.auth-container {\n  display: flex;\n  height: 100vh;\n  overflow: hidden;\n}\n\n.auth-background {\n  flex: 1;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  position: relative;\n  overflow: hidden;\n}\n\n.auth-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.3);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 40px;\n}\n\n.auth-logo {\n  text-align: center;\n  color: white;\n}\n\n.auth-logo i {\n  font-size: 80px;\n  margin-bottom: 20px;\n  opacity: 0.9;\n}\n\n.auth-logo h1 {\n  font-size: 36px;\n  font-weight: 300;\n  margin: 0 0 10px 0;\n  opacity: 0.95;\n}\n\n.auth-logo p {\n  font-size: 16px;\n  opacity: 0.8;\n  font-weight: 300;\n}\n\n.auth-card {\n  width: 500px;\n  background: white;\n  padding: 60px 50px;\n  display: flex;\n  flex-direction: column;\n  box-shadow: -2px 0 20px rgba(0, 0, 0, 0.1);\n  z-index: 1;\n  overflow-y: auto;\n}\n\n.auth-header {\n  margin-bottom: 40px;\n  text-align: center;\n}\n\n.auth-header h2 {\n  font-size: 28px;\n  font-weight: 600;\n  color: #333;\n  margin: 0 0 10px 0;\n}\n\n.auth-header p {\n  color: #666;\n  font-size: 14px;\n  margin: 0;\n}\n\n.form-group {\n  margin-bottom: 24px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  color: #555;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.role-radio-group {\n    display: flex;\n    flex-direction: row; /* 确保水平排列 */\n    gap: 1px; /* 按钮之间的间距 */\n}\n\n\n\n.role-radio-group .el-radio-button:first-child .el-radio-button__inner {\n  border-radius: 4px 0 0 4px;\n}\n\n.role-radio-group .el-radio-button:last-child .el-radio-button__inner {\n  border-radius: 0 4px 4px 0;\n}\n\n.code-container {\n  display: flex;\n  gap: 10px;\n  align-items: center;\n}\n\n.code-image-wrapper {\n  width: 180px;\n  height: 40px;\n  border-radius: 4px;\n  overflow: hidden;\n  border: 1px solid #dcdfe6;\n}\n\n.form-actions {\n  margin: 30px 0 20px 0;\n  display: flex;\n  gap: 15px;\n}\n\n.auth-btn {\n  flex: 2;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  border: none;\n  font-size: 16px;\n  font-weight: 500;\n  height: 48px;\n}\n\n.auth-btn:hover {\n  opacity: 0.9;\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n  transition: all 0.3s ease;\n}\n\n.home-btn {\n  flex: 1;\n  height: 48px;\n  font-size: 16px;\n}\n\n.auth-footer {\n  display: flex;\n  justify-content: space-between;\n  margin: 20px 0 30px 0;\n}\n\n.auth-link {\n  color: #667eea;\n  text-decoration: none;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  gap: 5px;\n  transition: color 0.3s;\n}\n\n.auth-link:hover {\n  color: #764ba2;\n  text-decoration: underline;\n}\n\n.divider {\n  position: relative;\n  text-align: center;\n  margin: 30px 0;\n  color: #999;\n  font-size: 14px;\n}\n\n.divider::before {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 0;\n  right: 0;\n  height: 1px;\n  background: #eee;\n  z-index: 0;\n}\n\n.divider span {\n  position: relative;\n  display: inline-block;\n  padding: 0 20px;\n  background: white;\n  z-index: 1;\n}\n\n.social-login {\n  display: flex;\n  justify-content: center;\n  gap: 20px;\n  margin-top: 20px;\n}\n\n.social-btn {\n  width: 44px;\n  height: 44px;\n  border: none;\n  font-size: 20px;\n  transition: all 0.3s;\n}\n\n.social-btn:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.wechat {\n  background: #07c160;\n  color: white;\n}\n\n.wechat:hover {\n  background: #06ad56;\n}\n\n.qq {\n  background: #12b7f5;\n  color: white;\n}\n\n.qq:hover {\n  background: #0ea5dd;\n}\n\n.weibo {\n  background: #e6162d;\n  color: white;\n}\n\n.weibo:hover {\n  background: #d01428;\n}\n\n/* 响应式设计 */\n@media (max-width: 768px) {\n  .auth-container {\n    flex-direction: column;\n  }\n  \n  .auth-background {\n    height: 200px;\n    flex: none;\n  }\n  \n  .auth-overlay {\n    padding: 20px;\n  }\n  \n  .auth-logo i {\n    font-size: 50px;\n  }\n  \n  .auth-logo h1 {\n    font-size: 24px;\n  }\n  \n  .auth-card {\n    width: 100%;\n    padding: 30px 20px;\n    box-shadow: none;\n  }\n  \n  .form-actions {\n    flex-direction: column;\n  }\n}\n</style>"],"mappings":";AA6IA,OAAAA,SAAA;AACA,OAAAC,KAAA;AAEA;EACAC,IAAA;EACAC,UAAA;IACAH;EACA;EACAI,KAAA;IACA;MACAC,QAAA;QACAC,QAAA;QACAC,QAAA;QACAC,QAAA;QACAC,IAAA;MACA;MACAC,WAAA;MACAC,OAAA;MACAC,KAAA;QACAN,QAAA,GACA;UAAAO,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA,EACA;QACAR,QAAA,GACA;UAAAM,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,GAAA;UAAAC,GAAA;UAAAH,OAAA;UAAAC,OAAA;QAAA,EACA;QACAP,QAAA,GACA;UAAAK,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,EACA;QACAN,IAAA,GACA;UAAAI,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UACAG,SAAA,EAAAA,CAAAC,IAAA,EAAAC,KAAA,EAAAC,QAAA;YACA,IAAAC,YAAA,QAAAC,KAAA,CAAAvB,SAAA,EAAAwB,OAAA;YACA,KAAAF,YAAA,IAAAF,KAAA,KAAAE,YAAA;cACAD,QAAA,KAAAI,KAAA;YACA;cACAJ,QAAA;YACA;UACA;UACAN,OAAA;QACA;MAEA;IACA;EACA;EACAW,QAAA;IACA,KAAAC,cAAA;EACA;EACAC,OAAA;IACA,MAAAD,eAAA;MACA;QACA;UAAAE,IAAA;YAAAC;UAAA;QAAA,eAAAC,KAAA;QACA,KAAArB,WAAA,GAAAoB,KAAA;QACA;QACA,IAAAA,KAAA,CAAAE,MAAA,cAAA3B,QAAA,CAAAG,QAAA;UACA,KAAAH,QAAA,CAAAG,QAAA,GAAAsB,KAAA,IAAArB,IAAA;QACA;MACA,SAAAwB,KAAA;QACAC,OAAA,CAAAD,KAAA,cAAAA,KAAA;MACA;IACA;IAEA,MAAAE,SAAA;MACA;QACA,WAAAZ,KAAA,CAAAa,SAAA,CAAAC,QAAA;QAEA,KAAA1B,OAAA;QACA,MAAA2B,GAAA,SAAArC,KAAA,CAAAsC,QAAA,eAAAlC,QAAA;QAEA,IAAAiC,GAAA,CAAAE,OAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;YACA5B,OAAA;YACA6B,QAAA;YACAC,SAAA;UACA;;UAEA;UACAC,UAAA;YACA,KAAAC,OAAA,CAAAC,IAAA;cAAAC,IAAA;YAAA;UACA;QACA;UACA,KAAAP,QAAA,CAAAR,KAAA,CAAAK,GAAA,CAAAW,OAAA;UACA,KAAA1B,KAAA,CAAAvB,SAAA,EAAAkD,WAAA;QACA;MACA,SAAAjB,KAAA;QACAC,OAAA,CAAAD,KAAA,UAAAA,KAAA;QACA,KAAAQ,QAAA,CAAAR,KAAA;QACA,KAAAV,KAAA,CAAAvB,SAAA,EAAAkD,WAAA;MACA;QACA,KAAAvC,OAAA;MACA;IACA;IAEAwC,OAAA;MACA,KAAAL,OAAA,CAAAC,IAAA;QAAAC,IAAA;MAAA;IACA;IAEAI,eAAA;MACA,KAAAX,QAAA,CAAAY,IAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}